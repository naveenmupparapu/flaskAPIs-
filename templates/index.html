{% extends "base.html" %}

{% block content %}
<section class="cards">
  <div class="card">
    <div class="label">Rooms</div>
    <div class="value">{{ room_count }}</div>
  </div>
  <div class="card">
    <div class="label">Residents</div>
    <div class="value">{{ resident_count }}</div>
  </div>
</section>

<section class="panel">
  <div class="panel-header">
    <h2>Available Rooms</h2>
    <a class="cta" href="{{ url_for('rooms') }}">Manage rooms</a>
  </div>
  <div class="table">
    <div class="table-head">
      <div>Name</div>
      <div>Capacity</div>
      <div>Occupied</div>
      <div>Status</div>
    </div>
    {% for room in rooms %}
      <div class="table-row">
        <div>{{ room.name }}</div>
        <div>{{ room.capacity }}</div>
        <div>{{ room.occupied }}</div>
        <div class="{{ 'ok' if room.has_space else 'warn' }}">
          {{ "Space available" if room.has_space else "Full" }}
        </div>
      </div>
    {% else %}
      <div class="table-row muted">No rooms yet.</div>
    {% endfor %}
  </div>
</section>

<section class="panel">
  <div class="panel-header">
    <h2>Recent check-ins</h2>
    <a class="cta" href="{{ url_for('residents') }}">Manage residents</a>
  </div>
  <div class="table">
    <div class="table-head">
      <div>Name</div>
      <div>Room</div>
      <div>Checked in</div>
    </div>
    {% for resident in recent_residents %}
      <div class="table-row">
        <div>{{ resident.full_name }}</div>
        <div>{{ resident.room.name if resident.room else "Unassigned" }}</div>
        <div>{{ resident.check_in.strftime("%Y-%m-%d %H:%M") }}</div>
      </div>
    {% else %}
      <div class="table-row muted">No residents yet.</div>
    {% endfor %}
  </div>
</section>
{% endblock %}